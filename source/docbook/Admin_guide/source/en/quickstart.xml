<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="http://docbook.org/xml/5.1/rng/docbook.rng" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="http://docbook.org/xml/5.1/sch/docbook.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>

<!-- The XSL transform inserts these values as Hugo frontmatter. -->
<!-- Additionally, a "date" timestamp is inserted by the stylesheet. -->
<?title ?> 
<?linkTitle "Quickstart guide" ?>  <!-- Section menu link text -->
<?url "docs/admin_guide/quickstart.html" ?> <!-- Required to make image links work -->
<?description "" ?> <!-- Optional -->
<?draft true ?> <!-- Optional -->
<?slug "" ?> <!-- Optional -->
<?layout "" ?> <!-- Optional -->
<?type "" ?> <!-- Optional -->
<?weight 10 ?> <!-- Optional -->

<!DOCTYPE article [
    <!ENTITY % shared-content SYSTEM "../../../shared-content.ent">
    %shared-content;
]>

<article    xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" 
    xml:id="quickstart">

    <info>
        <title xml:id="quickstart.title">Quickstart guide</title>    
    </info>
    <para>This topic provides collects basic &program_name; commands and other information in a
        single convenient place.</para>
    <section>
        <title>General</title>
        <section>
            <title>Git repository</title>
            <para><link xlink:href="https://github.com/katzenpost"/></para>
        </section>
        <section>
            <title>Project website</title>
            <para><link xlink:href="https://katzenpost.network"/></para>
        </section>
    </section>
    <section>
        <title>Where are the files?</title>
        <section>
            <title>Docker test mixnet</title>
            <para>As provided, the <filename>docker</filename> directory consists of a Makefile and
                and instructions for using it. Software prerequisites (other than Docker) are
                downloaded during installation, along with the &program_name; source code, which is
                built and launched inside of a Docker container. For more information, see  </para>
            <table frame="all">
                <title/>
                <tgroup cols="3">
                    <colspec colnum="1" colname="c1" colwidth="1*"/>
                    <colspec colnum="2" colname="newCol2" colwidth="1*"/>
                    <colspec colnum="3" colname="c2" colwidth="1*"/>
                    <thead>
                        <row>
                            <entry>
                                <para>Directory</para>
                            </entry>
                            <entry>
                                <para>File</para>
                            </entry>
                            <entry>
                                <para>Comment</para>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <para><filename>../katzenpost/docker</filename></para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para><filename>Makefile</filename></para>
                            </entry>
                            <entry>
                                <para>Makefile to build the test mixnet</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para><filename>README.rst</filename></para>
                            </entry>
                            <entry>
                                <para>Installation instructions</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><filename>../katzenpost/docker/voting_mixnet</filename></para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para>Only present after installation</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><filename>../katzenpost/docker/voting_mixnet/auth1</filename></para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para>authority.toml</para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para>identity.private.pem</para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para/>
                            </entry>
                            <entry>
                                <para>identity.public.pem</para>
                            </entry>
                            <entry>
                                <para/>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section>
            <title>Single &program_name; node in a production network</title>
            <para>The example shows the components and configuration of a mix node. Other node types
                (gateway, service, and directory authority) have a corresponding binary executable,
                a TOML configuration file, a local private/public key pair, and public keys for each
                peer in the mixnet.</para>
            <para>
                <table frame="all">
                    <title/>
                    <tgroup cols="3">
                        <colspec colnum="1" colname="c1" colwidth="1*"/>
                        <colspec colnum="2" colname="newCol2" colwidth="1*"/>
                        <colspec colnum="3" colname="c2" colwidth="1*"/>
                        <thead>
                            <row>
                                <entry>
                                    <para>Directory</para>
                                </entry>
                                <entry>
                                    <para>File</para>
                                </entry>
                                <entry>Comment</entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <para><filename>/etc/pq-katzenpost-mixserver</filename></para>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                            </row>
                            <row>
                                <entry/>
                                <entry><filename>katzenpost.toml</filename></entry>
                                <entry>
                                    <para>Main configuration.</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para><filename>/var/lib/pq-katzenpost-mixserver/</filename></para>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>identity.private.pem</filename></para>
                                </entry>
                                <entry>
                                    <para>Local node private identity key</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>identity.public.pem</filename></para>
                                </entry>
                                <entry>
                                    <para>Local node public identity key</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>link.private.pem</filename></para>
                                </entry>
                                <entry>
                                    <para>Local private key for encrypting Sphinx packages</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>link.public.pem</filename></para>
                                </entry>
                                <entry>
                                    <para>Local public key for encrypting Sphinx packages</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>mixkey-145374.db</filename></para>
                                </entry>
                                <entry>
                                    <para>Peer public identity key</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>mixkey-145375.db</filename></para>
                                </entry>
                                <entry>
                                    <para>Peer public identity key (etc.)</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para><filename>/usr/local/bin</filename></para>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para/>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>pq-katzenpost-authority</filename></para>
                                </entry>
                                <entry>
                                    <para>Directory authority executable</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para/>
                                </entry>
                                <entry>
                                    <para><filename>pq-katzenpost-mixserver</filename></para>
                                </entry>
                                <entry>
                                    <para>Server executable (includes mix, gateway, and service
                                        nodes)</para>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </para>
            <para/>
            
            
            
            
        </section>
        
        
<!--        <table frame="all">
            <title/>
            <tgroup cols="2">
                <colspec colnum="1" colname="c1" colwidth="1*"/>
                <colspec colnum="2" colname="c2" colwidth="1*"/>
                <thead>
                    <row>
                        <entry><para></para></entry>
                        <entry><para></para></entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>
                            <para>/etc/pq-katzenpost-mixserver</para>
                        </entry>
                        <entry>
                            <para></para>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para> 
                        </entry>
                        <entry>
                            <para></para>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para> 
                        </entry>
                        <entry>
                            <para></para>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para>
                        </entry>
                        <entry>
                            <para></para>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para>  
                        </entry>
                        <entry>
                            <para></para> 
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para>  
                        </entry>
                        <entry>
                            <para></para>  
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para> 
                        </entry>
                        <entry>
                            <para></para>  
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <para></para> 
                        </entry>
                        <entry>
                            <para></para>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>   -->
        
        
        
    </section>
        <section>
            <title><code>Service management</code></title>
            <para><code><emphasis role="bold">systemctl start
                    pq-katzenpost-mixserver</emphasis></code></para>
            <para><code><emphasis role="bold">systemctl st</emphasis></code><code><emphasis role="bold">op</emphasis></code><code><emphasis role="bold">
                        pq-katzenpost-mixserver</emphasis></code></para>
            <para><code><emphasis role="bold">systemctl </emphasis></code><code><emphasis role="bold">re</emphasis></code><code><emphasis role="bold">start
                        pq-katzenpost-mixserver</emphasis></code></para>
            <para><code><emphasis role="bold">systemctl </emphasis></code><code><emphasis role="bold">enable</emphasis></code><code><emphasis role="bold">
                        pq-katzenpost-mixserver</emphasis></code></para>
        </section>
        <section>
            <title><code>Monitoring</code></title>
            <para><code><emphasis role="bold">journalctl -u pq-katzenpost-mixserver -f -n
                        2000</emphasis></code></para>
            <para><code><emphasis role="bold">iftop -t -s 18000 &gt; log.txt
                &amp;</emphasis></code></para>
            <para><code><emphasis role="bold">bmon -p ens3</emphasis></code></para>
            <para><emphasis role="bold">Log the system stats and active process every 5
                    seconds</emphasis></para>
            <para> dwrob@hoh:~$ top -i -b -d 5 &gt; top-watchdog.txt</para>
            <para><emphasis role="bold">Keep an eye on the active updating of that
                file</emphasis></para>
            <para> dwrob@hoh:~$ watch -d ls -l </para>
            <para> Every 2.0s: ls -al top-watchdog.txt hoh: Sun Dec 4 11:06:17 2022</para>
            <para> -rw-r--r-- 1 dwrob dwrob 16016638 Dec 4 11:06 top-watchdog.txt</para>
            <para><emphasis role="bold">Watch the actual updates</emphasis></para>
            <para> dwrob@hoh:~$ tail -f top-watchdog.txt</para>
            <para><emphasis role="bold">Capture net/disk/sys stats in CSV</emphasis></para>
            <para> dwrob@hoh:~$ dstat -tndcgy -N enp40s0 --output dstat.csv</para>
            <para><emphasis role="bold">And in general</emphasis></para>
            <para><code>dwrob@hoh:~$ bpytop</code></para>
        </section>
</article>
